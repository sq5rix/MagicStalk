#:kivy 1.0.9
#:import Factory kivy.factory.Factory

#:set color_button (0.784, 0.443, 0.216, 1)  # brown
#:set color_button_pressed (0.659, 0.522, 0.431, 1)  # darker brown
#:set color_font   (0.957, 0.890, 0.843, 1)  # off white

<MySpinnerOption@SpinnerOption>:
    background_color: color_button if self.state == 'down' else color_button_pressed
    color: color_font

<Label>:
    font_size: self.height / 4
<Button>:
    background_color: (0.2, 0.6, 0.3, 1)
    color: color_font
    font_size: self.height / 4
<TextInput>:
    font_size: self.height / 4

<MainScreen>:
    id: main_screen
    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'top'
        StackLayout:
            id: stack
            orientation: 'lr-tb'
            cols: 10
            Button:
                size_hint_x: 0.2
                size_hint_y: 0.2
                text: '+'
                on_release: root.manager.current='Flower Screen'

<FlowerScreen>:

    obj_cur_mst: cur_mst
    obj_avg_mst: avg_mst
    obj_cur_temp: cur_temp
    obj_adj_mst: adj_mst
    obj_usb_port: usb_port

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'top'
        StackLayout:
            size_hint_x: 0.4
            size_hint_y: 0.1
            orientation: 'lr-tb'
            Label:
                text: 'Flower Name'
            TextInput:
                id: text_input
                font_size: self.height * 0.6
                multiline: False
                focus: True
                on_text_validate:
                    root.manager.flower_name=self.text
                    root.manager.current='Main Screen'

    AnchorLayout:
        anchor_x: 'right'
        anchor_y: 'bottom'
        Button:
            text: 'OK'
            size_hint: 0.18, 0.12
            on_release:
                root.manager.flower_name=root.manager.flower_screen.ids.text_input.text
                root.manager.current='Main Screen'

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        Button:
            text: 'Cancel'
            size_hint: 0.18, 0.12
            on_release:
                root.manager.current='Main Screen'

    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        Button:
            background_color: (1, 0, 0.1, 1)
            text: 'Delete'
            size_hint: 0.18, 0.12
            on_release: root.manager.current='Main Screen'

    AnchorLayout:
        anchor_x: 'right'
        anchor_y: 'top'
        GridLayout:
            cols: 2
            size_hint: 0.5, 0.7
            Label:
                text: 'Current Moisture'
            Label:
                id: cur_mst
                text: ''
            Label:
                text: 'Average Moisture'
            Label:
                id: avg_mst
                text: ''
            Label:
                text: 'Temperature'
            Label:
                id: cur_temp
                text: ''
            Label:
                text: 'Adjusted Moisture'
            Label:
                id: adj_mst
                text: ''
            Label:
                text: 'USB Port'
            Spinner:
                id: usb_port
                background_color: (1, 1, 1, 1)
                font_size: self.height / 4
                text: 'None'
                values: root.port_list
                background_color: color_button if self.state == 'normal' else color_button_pressed
                color: color_font
                option_cls: Factory.get("MySpinnerOption")
                on_text:
                    root.chosen_port = self.text

<Manager>:
    id: screen_manager

    main_screen: main_screen
    flower_screen: flower_screen

    MainScreen:
        id: main_screen
        name: "Main Screen"
        manager: screen_manager

    FlowerScreen:
        id: flower_screen
        name: "Flower Screen"
        manager: screen_manager


